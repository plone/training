

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>18. Views III: A Talk list &mdash; Mastering Plone 1.2 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700|Roboto+Slab:400,700|Inconsolata:400,700' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
    <link rel="top" title="Mastering Plone 1.2 documentation" href="index.html"/>
        <link rel="next" title="19. Behaviors" href="behaviors1.html"/>
        <link rel="prev" title="17. Views II: A default view for “talk”" href="views_2.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        <a href="index.html" class="fa fa-home"> Mastering Plone</a>
        <div role="search">
  <form id ="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
        
            <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro.html">1. Introduction</a><ul>
<li class="toctree-l2"><a class="reference internal" href="intro.html#who-are-we">Who are we?</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#who-are-you">Who are you?</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#what-will-we-do">What will we do?</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#what-will-we-not-do">What will we not do?</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#what-to-expect">What to expect</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#documentation">Documentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="intro.html#further-reading">Further Reading</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="installation.html">2. Installation &amp; Setup</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#installing-plone">Installing Plone</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#hosting-plone">Hosting Plone</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="plone_training_config/instructions.html">3. Installing Plone for the Training</a><ul>
<li class="toctree-l2"><a class="reference internal" href="plone_training_config/instructions.html#install-virtualbox">Install VirtualBox</a></li>
<li class="toctree-l2"><a class="reference internal" href="plone_training_config/instructions.html#install-and-configure-vagrant">Install and configure Vagrant</a></li>
<li class="toctree-l2"><a class="reference internal" href="plone_training_config/instructions.html#what-vagrant-does">What Vagrant does</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="case.html">4. The Case-Study</a><ul>
<li class="toctree-l2"><a class="reference internal" href="case.html#background">Background</a></li>
<li class="toctree-l2"><a class="reference internal" href="case.html#requirements">Requirements</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="anatomy.html">5. The Anatomy of Plone</a><ul>
<li class="toctree-l2"><a class="reference internal" href="anatomy.html#zope2">Zope2</a></li>
<li class="toctree-l2"><a class="reference internal" href="anatomy.html#content-management-framework">Content Management Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="anatomy.html#zope-toolkit-zope3">Zope Toolkit / Zope3</a></li>
<li class="toctree-l2"><a class="reference internal" href="anatomy.html#zope-component-architecture-zca">Zope Component Architecture (ZCA)</a></li>
<li class="toctree-l2"><a class="reference internal" href="anatomy.html#pyramid">Pyramid</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="features.html">6. The Features of Plone</a><ul>
<li class="toctree-l2"><a class="reference internal" href="features.html#starting-and-stopping-plone">Starting and Stopping Plone</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html#users">Users</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html#configure-a-mailserver">Configure a Mailserver</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html#walktrough-of-the-ui">Walktrough of the UI</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html#content-types">Content-Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html#folders">Folders</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html#collections">Collections</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html#content-rules">Content Rules</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html#history">History</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html#manage-members-and-groups">Manage members and groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html#workflows">Workflows</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html#working-copy">Working copy</a></li>
<li class="toctree-l2"><a class="reference internal" href="features.html#placeful-workflows">Placeful workflows</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="configuring_customizing.html">7. Configuring and Customizing Plone through the web</a><ul>
<li class="toctree-l2"><a class="reference internal" href="configuring_customizing.html#the-control-panel">The Control Panel</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuring_customizing.html#portlets">Portlets</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuring_customizing.html#viewlets">Viewlets</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuring_customizing.html#zmi">ZMI</a></li>
<li class="toctree-l2"><a class="reference internal" href="configuring_customizing.html#summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="extending.html">8. Extending Plone</a><ul>
<li class="toctree-l2"><a class="reference internal" href="extending.html#extension-technologies">Extension technologies</a></li>
<li class="toctree-l2"><a class="reference internal" href="extending.html#what-are-components-what-is-zcml">What are components, what is ZCML</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="addons.html">9. Extend Plone with Add-ons</a><ul>
<li class="toctree-l2"><a class="reference internal" href="addons.html#how-to-find-addons">How to find addons</a></li>
<li class="toctree-l2"><a class="reference internal" href="addons.html#some-noteable-addons">Some noteable addons</a></li>
<li class="toctree-l2"><a class="reference internal" href="addons.html#installing-addons">Installing Addons</a></li>
<li class="toctree-l2"><a class="reference internal" href="addons.html#ploneformgen">PloneFormGen</a></li>
<li class="toctree-l2"><a class="reference internal" href="addons.html#add-photogallery-with-collective-plonetruegallery">Add Photogallery with collective.plonetruegallery</a></li>
<li class="toctree-l2"><a class="reference internal" href="addons.html#internationalisation">Internationalisation</a></li>
<li class="toctree-l2"><a class="reference internal" href="addons.html#summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="theming.html">10. Theming</a></li>
<li class="toctree-l1"><a class="reference internal" href="buildout_1.html">11. Buildout I</a><ul>
<li class="toctree-l2"><a class="reference internal" href="buildout_1.html#syntax">Syntax</a></li>
<li class="toctree-l2"><a class="reference internal" href="buildout_1.html#references">References</a></li>
<li class="toctree-l2"><a class="reference internal" href="buildout_1.html#a-real-life-example">A real life example</a></li>
<li class="toctree-l2"><a class="reference internal" href="buildout_1.html#hello-mr-developer">Hello mr.developer!</a></li>
<li class="toctree-l2"><a class="reference internal" href="buildout_1.html#extensible">Extensible</a></li>
<li class="toctree-l2"><a class="reference internal" href="buildout_1.html#be-mcguyver">Be McGuyver</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="eggs1.html">12. Creating your own eggs to customize Plone</a></li>
<li class="toctree-l1"><a class="reference internal" href="dexterity.html">13. Dexterity I: Through the web</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dexterity.html#what-is-a-content-type">What is a content-type?</a></li>
<li class="toctree-l2"><a class="reference internal" href="dexterity.html#dexterity-and-archetypes-a-comparison">Dexterity and Archetypes - A Comparison</a></li>
<li class="toctree-l2"><a class="reference internal" href="dexterity.html#installation">Installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="dexterity.html#modifying-existing-types">Modifying existing types</a></li>
<li class="toctree-l2"><a class="reference internal" href="dexterity.html#creating-content-types-ttw">Creating content-types TTW</a></li>
<li class="toctree-l2"><a class="reference internal" href="dexterity.html#moving-content-types-into-code">Moving content-types into code</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="views_1.html">14. Views I</a><ul>
<li class="toctree-l2"><a class="reference internal" href="views_1.html#a-simple-browser-view">A simple browser view</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="zpt.html">15. Zope Page Templates</a><ul>
<li class="toctree-l2"><a class="reference internal" href="zpt.html#tal-and-tales">TAL and TALES</a></li>
<li class="toctree-l2"><a class="reference internal" href="zpt.html#metal-and-macros">METAL and macros</a></li>
<li class="toctree-l2"><a class="reference internal" href="zpt.html#accessing-plone-from-the-template">Accessing Plone from the template</a></li>
<li class="toctree-l2"><a class="reference internal" href="zpt.html#what-we-missed">What we missed</a></li>
<li class="toctree-l2"><a class="reference internal" href="zpt.html#chameleon">Chameleon</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="zpt_2.html">16. Customizing existing templates</a><ul>
<li class="toctree-l2"><a class="reference internal" href="zpt_2.html#newsitem-pt">newsitem.pt</a></li>
<li class="toctree-l2"><a class="reference internal" href="zpt_2.html#summary-view-pt">summary_view.pt</a></li>
<li class="toctree-l2"><a class="reference internal" href="zpt_2.html#finding-the-right-template">Finding the right template</a></li>
<li class="toctree-l2"><a class="reference internal" href="zpt_2.html#skin-templates">skin-templates</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="views_2.html">17. Views II: A default view for &#8220;talk&#8221;</a><ul>
<li class="toctree-l2"><a class="reference internal" href="views_2.html#view-classes">View-Classes</a></li>
<li class="toctree-l2"><a class="reference internal" href="views_2.html#the-default-view">The default-view</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">18. Views III: A Talk list</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#using-portal-catalog">Using portal_catalog</a></li>
<li class="toctree-l2"><a class="reference internal" href="#brains-and-objects">brains and objects</a></li>
<li class="toctree-l2"><a class="reference internal" href="#querying-the-catalog">Querying the catalog</a></li>
<li class="toctree-l2"><a class="reference internal" href="#the-template-for-the-listing">The template for the listing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setting-a-custom-view-as-default-view-on-an-object">Setting a custom view as default-view on an object</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adding-some-javascript-collective-js-datatables">Adding some javascript (collective.js.datatables)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="behaviors1.html">19. Behaviors</a><ul>
<li class="toctree-l2"><a class="reference internal" href="behaviors1.html#dexterity-approach">Dexterity Approach</a></li>
<li class="toctree-l2"><a class="reference internal" href="behaviors1.html#names-and-theory">Names and Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="behaviors1.html#practical-example">Practical example</a></li>
<li class="toctree-l2"><a class="reference internal" href="behaviors1.html#adding-it-to-our-talk">Adding it to our talk</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="viewlets_1.html">20. Writing Viewlets</a><ul>
<li class="toctree-l2"><a class="reference internal" href="viewlets_1.html#a-viewlet-for-the-social-behavior">A viewlet for the social behavior</a></li>
<li class="toctree-l2"><a class="reference internal" href="viewlets_1.html#social-viewlet">social-viewlet</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">21. Programming Plone</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api.html#plone-api">plone.api</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#portal-tools">portal-tools</a></li>
<li class="toctree-l2"><a class="reference internal" href="api.html#debugging">Debugging</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="ide.html">22. IDE&#8217;s and Editors</a></li>
<li class="toctree-l1"><a class="reference internal" href="dexterity_2.html">23. Dexterity Types II: Growing up</a><ul>
<li class="toctree-l2"><a class="reference internal" href="dexterity_2.html#add-a-marker-interface-to-the-talk-type">Add a marker-interface to the talk-type</a></li>
<li class="toctree-l2"><a class="reference internal" href="dexterity_2.html#upgrade-steps">Upgrade-steps</a></li>
<li class="toctree-l2"><a class="reference internal" href="dexterity_2.html#add-a-browserlayer">Add a browserlayer</a></li>
<li class="toctree-l2"><a class="reference internal" href="dexterity_2.html#add-catalog-indexes">Add catalog-indexes</a></li>
<li class="toctree-l2"><a class="reference internal" href="dexterity_2.html#query-for-custom-indexes">Query for custom indexes</a></li>
<li class="toctree-l2"><a class="reference internal" href="dexterity_2.html#add-collection-criteria">Add collection criteria</a></li>
<li class="toctree-l2"><a class="reference internal" href="dexterity_2.html#add-more-features-through-generic-setup">Add more features through generic-setup</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="custom_search.html">24. Custom search</a><ul>
<li class="toctree-l2"><a class="reference internal" href="custom_search.html#eea-facetednavigation">eea.facetednavigation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="events.html">25. Turn talks into events</a></li>
<li class="toctree-l1"><a class="reference internal" href="user_generated_content.html">26. User generated content</a><ul>
<li class="toctree-l2"><a class="reference internal" href="user_generated_content.html#self-registration">Self-registration</a></li>
<li class="toctree-l2"><a class="reference internal" href="user_generated_content.html#a-custom-workflow-for-talks">A custom workflow for talks</a></li>
<li class="toctree-l2"><a class="reference internal" href="user_generated_content.html#grant-local-roles">Grant local roles</a></li>
<li class="toctree-l2"><a class="reference internal" href="user_generated_content.html#move-the-changes-to-the-file-system">Move the changes to the file-system</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="resources.html">27. Resources</a></li>
<li class="toctree-l1"><a class="reference internal" href="thirdparty_behaviors.html">28. Using third-party behaviors</a><ul>
<li class="toctree-l2"><a class="reference internal" href="thirdparty_behaviors.html#add-teaser-with-collective-behavior-banner">Add teaser with collective.behavior.banner</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dexterity_3.html">29. Dexterity Types III: Python</a></li>
<li class="toctree-l1"><a class="reference internal" href="eggs2.html">30. Creating reusable packages with eggs</a></li>
<li class="toctree-l1"><a class="reference internal" href="behaviors2.html">31. More complex behaviors</a><ul>
<li class="toctree-l2"><a class="reference internal" href="behaviors2.html#using-annotations">Using Annotations</a></li>
<li class="toctree-l2"><a class="reference internal" href="behaviors2.html#using-schema">Using Schema</a></li>
<li class="toctree-l2"><a class="reference internal" href="behaviors2.html#writing-code">Writing Code</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="viewlets_2.html">32. A viewlet for the voteable behavior</a><ul>
<li class="toctree-l2"><a class="reference internal" href="viewlets_2.html#voting-viewlet">Voting Viewlet</a></li>
<li class="toctree-l2"><a class="reference internal" href="viewlets_2.html#writing-the-viewlet-code">Writing the Viewlet code</a></li>
<li class="toctree-l2"><a class="reference internal" href="viewlets_2.html#the-template">The template</a></li>
<li class="toctree-l2"><a class="reference internal" href="viewlets_2.html#the-javascript-code">The javascript code</a></li>
<li class="toctree-l2"><a class="reference internal" href="viewlets_2.html#writing-2-simple-view-helpers">Writing 2 simple view helpers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="reusable.html">33. Making our package reusable</a><ul>
<li class="toctree-l2"><a class="reference internal" href="reusable.html#adding-permissions">Adding permissions</a></li>
<li class="toctree-l2"><a class="reference internal" href="reusable.html#using-our-permissions">Using our permissions</a></li>
<li class="toctree-l2"><a class="reference internal" href="reusable.html#provide-defaults">Provide defaults</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="embed.html">34. Using starzel.votable_behavior in ploneconf.site</a></li>
<li class="toctree-l1"><a class="reference internal" href="deployment_sites.html">35. Buildout II: Getting ready for deployment</a><ul>
<li class="toctree-l2"><a class="reference internal" href="deployment_sites.html#the-starzel-buildout">The starzel-buildout</a></li>
<li class="toctree-l2"><a class="reference internal" href="deployment_sites.html#a-deployment-setup">A deployment-setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="deployment_sites.html#other-tools-we-use">Other tools we use</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="future_of_plone.html">36. The Future of Plone</a></li>
<li class="toctree-l1"><a class="reference internal" href="optional.html">37. Optional</a></li>
</ul>

        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">Mastering Plone</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>18. Views III: A Talk list</li>
      <li class="wy-breadcrumbs-aside">
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main">
            
  <div class="section" id="views-iii-a-talk-list">
<h1>18. Views III: A Talk list<a class="headerlink" href="#views-iii-a-talk-list" title="Permalink to this headline">¶</a></h1>
<div class="sidebar">
<p class="first sidebar-title">Get the code!</p>
<p>Get the code for this chapter (<a class="reference internal" href="sneak.html"><em>More info</em></a>) using this command in the buildout-directory:</p>
<div class="last highlight-bash"><div class="highlight"><pre>cp -Rf src/ploneconf.site_sneak/chapters/18_views_3/ src/ploneconf.site
</pre></div>
</div>
</div>
<p>Now we don&#8217;t want to provide information about one specific item but on several items. What now? We can&#8217;t look at several items at the same time as context.</p>
<div class="section" id="using-portal-catalog">
<h2>Using portal_catalog<a class="headerlink" href="#using-portal-catalog" title="Permalink to this headline">¶</a></h2>
<p>Let&#8217;s say we want so show a list of all the talks that were submitted for our conference. We can just go to the folder and select a display-method that suits us. But none does because we want to show the target-audience in our listing.</p>
<p>So we need to get all the talks. For this we use the python-class of the view to query the catalog for the talks.</p>
<p>The catalog is like a search-engine for the content on our site. It holds information about all the objects as well as some of their attributes like title, decription, workflow_state, keywords that they were tagged with, author, content_type, it&#8217;s path in the site etc. But it does not hold the content of &#8220;heavy&#8221; fields like images or files, richtext-fields and field that we just defined ourselves.</p>
<p>It is the fast way to get content that exists in the site and do something with it. From the results of the catalog we can get the objects themselves but often we don&#8217;t need them, but only the properties that the results already have.</p>
<p>ZCML</p>
<div class="highlight-xml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7
8</pre></div></td><td class="code"><div class="highlight"><pre><span class="nt">&lt;browser:page</span>
   <span class="na">name=</span><span class="s">&quot;talklistview&quot;</span>
   <span class="na">for=</span><span class="s">&quot;*&quot;</span>
   <span class="na">layer=</span><span class="s">&quot;zope.interface.Interface&quot;</span>
   <span class="na">class=</span><span class="s">&quot;.views.TalkListView&quot;</span>
   <span class="na">template=</span><span class="s">&quot;templates/talklistview.pt&quot;</span>
   <span class="na">permission=</span><span class="s">&quot;zope2.View&quot;</span>
   <span class="nt">/&gt;</span>
</pre></div>
</td></tr></table></div>
<p>Python</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">Products.CMFCore.utils</span> <span class="kn">import</span> <span class="n">getToolByName</span>
<span class="kn">from</span> <span class="nn">Products.Five.browser</span> <span class="kn">import</span> <span class="n">BrowserView</span>
<span class="kn">from</span> <span class="nn">plone.dexterity.browser.view</span> <span class="kn">import</span> <span class="n">DefaultView</span>


<span class="k">class</span> <span class="nc">DemoView</span><span class="p">(</span><span class="n">BrowserView</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; This does nothing so far</span>
<span class="sd">    &quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">TalkView</span><span class="p">(</span><span class="n">DefaultView</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; The default view for talks</span>
<span class="sd">    &quot;&quot;&quot;</span>


<span class="k">class</span> <span class="nc">TalkListView</span><span class="p">(</span><span class="n">BrowserView</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot; A list of talks</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">talks</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">portal_catalog</span> <span class="o">=</span> <span class="n">getToolByName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">,</span> <span class="s">&#39;portal_catalog&#39;</span><span class="p">)</span>
        <span class="n">current_path</span> <span class="o">=</span> <span class="s">&quot;/&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="o">.</span><span class="n">getPhysicalPath</span><span class="p">())</span>

        <span class="n">brains</span> <span class="o">=</span> <span class="n">portal_catalog</span><span class="p">(</span><span class="n">portal_type</span><span class="o">=</span><span class="s">&quot;talk&quot;</span><span class="p">,</span>
                                <span class="n">path</span><span class="o">=</span><span class="n">current_path</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">brain</span> <span class="ow">in</span> <span class="n">brains</span><span class="p">:</span>
            <span class="n">talk</span> <span class="o">=</span> <span class="n">brain</span><span class="o">.</span><span class="n">getObject</span><span class="p">()</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
                <span class="s">&#39;title&#39;</span><span class="p">:</span> <span class="n">brain</span><span class="o">.</span><span class="n">Title</span><span class="p">,</span>
                <span class="s">&#39;description&#39;</span><span class="p">:</span> <span class="n">brain</span><span class="o">.</span><span class="n">Description</span><span class="p">,</span>
                <span class="s">&#39;url&#39;</span><span class="p">:</span> <span class="n">brain</span><span class="o">.</span><span class="n">getURL</span><span class="p">(),</span>
                <span class="s">&#39;audience&#39;</span><span class="p">:</span> <span class="s">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">talk</span><span class="o">.</span><span class="n">audience</span><span class="p">),</span>
                <span class="s">&#39;type_of_talk&#39;</span><span class="p">:</span> <span class="n">talk</span><span class="o">.</span><span class="n">type_of_talk</span><span class="p">,</span>
                <span class="s">&#39;speaker&#39;</span><span class="p">:</span> <span class="n">talk</span><span class="o">.</span><span class="n">speaker</span><span class="p">,</span>
                <span class="s">&#39;uuid&#39;</span><span class="p">:</span> <span class="n">brain</span><span class="o">.</span><span class="n">UID</span><span class="p">,</span>
                <span class="p">})</span>
        <span class="k">return</span> <span class="n">results</span>
</pre></div>
</td></tr></table></div>
<p>We query the catalog for two things:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">portal_type</span> <span class="pre">=</span> <span class="pre">&quot;talk&quot;</span></tt></li>
<li><tt class="docutils literal"><span class="pre">path</span> <span class="pre">=</span> <span class="pre">&quot;/&quot;.join(self.context.getPhysicalPath())</span></tt></li>
</ul>
<p>We get the path of the current context to query only for objects in the current path. Otherwise we&#8217;d get all talks in the whole site. If we moved some talks to a different part of the site (e.g. a sub-conference for universities with a special talk-list) we might not want so see them in our listing.</p>
<p>We iterate over the list of results that the catalog returns us.</p>
<p>We create a dictionary that holds all the information we want to show in the template. This way we don&#8217;t have to put any complex logic into the template.</p>
</div>
<div class="section" id="brains-and-objects">
<h2>brains and objects<a class="headerlink" href="#brains-and-objects" title="Permalink to this headline">¶</a></h2>
<p>Objects are normally not loaded into memory but lie dormant in the Database ZODB. Waking objects up can be slow, especially if you&#8217;re waking up a lot of objects. Fortunately out talks are not especially heavy since they are</p>
<ul class="simple">
<li>dexterity-objects which are lighter than their archetypes-brothers</li>
<li>relatively few since we don&#8217;t have thousands of talks at our conference</li>
</ul>
<p>We want to show the target-audience but that attributes of the talks is not in the catalog. This is why we need to get to the objects themselves.</p>
<p>We could also add a new index to the catalog that will add &#8216;audience&#8217; to the properties of the brains. We have to weight pros and cons:</p>
<ul class="simple">
<li>talks are important and thus most likely always in memory</li>
<li>prevent bloating of catalog with indexes</li>
</ul>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p>The code to add such an index would look like this:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">plone.indexer.decorator</span> <span class="kn">import</span> <span class="n">indexer</span>
<span class="kn">from</span> <span class="nn">ploneconf.site.talk</span> <span class="kn">import</span> <span class="n">ITalk</span>

<span class="nd">@indexer</span><span class="p">(</span><span class="n">ITalk</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">talk_audience</span><span class="p">(</span><span class="nb">object</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">):</span>
     <span class="k">return</span> <span class="nb">object</span><span class="o">.</span><span class="n">audience</span>
</pre></div>
</div>
<p>We&#8217;d have to register this factory function as a named adapter in the <tt class="docutils literal"><span class="pre">configure.zcml</span></tt>. Assuming you&#8217;ve put the code above into a file named indexers.py</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;adapter</span> <span class="na">name=</span><span class="s">&quot;audience&quot;</span> <span class="na">factory=</span><span class="s">&quot;.indexers.talk_audience&quot;</span> <span class="nt">/&gt;</span>
</pre></div>
</div>
<p class="last">We will add some indexers later on.</p>
</div>
<p>Why use the catalog at all? It checks for permissions, and only returns the talks that the current user may see. They might be private or hidden to you since they are part of a top-secret conference for core-develeopers (there is no such thing!).</p>
<p>Most objects in plone act like dictionaries, so I could do context.values() to get all it&#8217;s contents.</p>
<p>For historical reasons some attributes of brains and objects are written differently:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span> <span class="o">=</span> <span class="n">brain</span><span class="o">.</span><span class="n">getObject</span><span class="p">()</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span><span class="o">.</span><span class="n">title</span>
<span class="go">u&#39;Talk-submission is open!&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">brain</span><span class="o">.</span><span class="n">Title</span> <span class="o">==</span> <span class="n">obj</span><span class="o">.</span><span class="n">title</span>
<span class="go">True</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">brain</span><span class="o">.</span><span class="n">title</span> <span class="o">==</span> <span class="n">obj</span><span class="o">.</span><span class="n">title</span>
<span class="go">False</span>
</pre></div>
</div>
<p>Who can guess what <tt class="docutils literal"><span class="pre">brain.title</span></tt> will return since the brain has no such attribute?</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">Answer: Acquisition will get the attribute from the nearest parent. <tt class="docutils literal"><span class="pre">brain.__parent__</span></tt> is <tt class="docutils literal"><span class="pre">&lt;CatalogTool</span> <span class="pre">at</span> <span class="pre">/Plone/portal_catalog&gt;</span></tt>. The attribute <tt class="docutils literal"><span class="pre">title</span></tt> of the <tt class="docutils literal"><span class="pre">portal_catalog</span></tt> is &#8216;Indexes all content in the site&#8217;.</p>
</div>
<p>Acquisition can be harmfull. Brains have no attribute &#8216;getLayout&#8217; <tt class="docutils literal"><span class="pre">brain.getLayout()</span></tt>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">brain</span><span class="o">.</span><span class="n">getLayout</span><span class="p">()</span>
<span class="go">&#39;folder_listing&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span><span class="o">.</span><span class="n">getLayout</span><span class="p">()</span>
<span class="go">&#39;newsitem_view&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">brain</span><span class="o">.</span><span class="n">getLayout</span>
<span class="go">&lt;bound method PloneSite.getLayout of &lt;PloneSite at /Plone&gt;&gt;</span>
</pre></div>
</div>
<p>The same is true for methods:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">obj</span><span class="o">.</span><span class="n">absolute_url</span><span class="p">()</span>
<span class="go">&#39;http://localhost:8080/Plone/news/talk-submission-is-open&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">brain</span><span class="o">.</span><span class="n">getURL</span><span class="p">()</span> <span class="o">==</span> <span class="n">obj</span><span class="o">.</span><span class="n">absolute_url</span><span class="p">()</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">brain</span><span class="o">.</span><span class="n">getPath</span><span class="p">()</span> <span class="o">==</span> <span class="s">&#39;/&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">obj</span><span class="o">.</span><span class="n">getPhysicalPath</span><span class="p">())</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
<div class="section" id="querying-the-catalog">
<h2>Querying the catalog<a class="headerlink" href="#querying-the-catalog" title="Permalink to this headline">¶</a></h2>
<p>The are many <a class="reference external" href="http://docs.plone.org/develop/plone/searching_and_indexing/indexing.html">catalog indexes</a> to query. Here are some examples:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">portal_catalog</span> <span class="o">=</span> <span class="n">getToolByName</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">context</span><span class="p">,</span> <span class="s">&#39;portal_catalog&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">portal_catalog</span><span class="p">(</span><span class="n">Subject</span><span class="o">=</span><span class="p">(</span><span class="s">&#39;cats&#39;</span><span class="p">,</span> <span class="s">&#39;dogs&#39;</span><span class="p">))</span>
<span class="go">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">portal_catalog</span><span class="p">(</span><span class="n">review_state</span><span class="o">=</span><span class="s">&#39;pending&#39;</span><span class="p">)</span>
<span class="go">[]</span>
</pre></div>
</div>
<p>Calling the catalog without parameters return the whole site:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="n">portal_catalog</span><span class="p">()</span>
<span class="go">[&lt;Products.ZCatalog.Catalog.mybrains object at 0x1085a11f0&gt;, &lt;Products.ZCatalog.Catalog.mybrains object at 0x1085a12c0&gt;, &lt;Products.ZCatalog.Catalog.mybrains object at 0x1085a1328&gt;, &lt;Products.ZCatalog.Catalog.mybrains object at 0x1085a13 ...</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference external" href="http://docs.plone.org/develop/plone/searching_and_indexing/query.html">http://docs.plone.org/develop/plone/searching_and_indexing/query.html</a></p>
</div>
</div>
<div class="section" id="the-template-for-the-listing">
<h2>The template for the listing<a class="headerlink" href="#the-template-for-the-listing" title="Permalink to this headline">¶</a></h2>
<p>Next the template in which we use the results of our method &#8216;talks&#8217;.</p>
<p>We try to keep logic mostly in python. This is for two reasons:</p>
<dl class="docutils">
<dt>Readability:</dt>
<dd>It&#8217;s much simpler to read python that complex tal-structures</dd>
<dt>Speed:</dt>
<dd>Python-code is faster than code executed in templates. It&#8217;s also easy to add caching to methods.</dd>
</dl>
<p>The MVC-Schema does not directly apply to Plone but look at it like this:</p>
<dl class="docutils">
<dt>Model:</dt>
<dd>the object</dd>
<dt>View:</dt>
<dd>the template</dd>
<dt>Controller:</dt>
<dd>the view</dd>
</dl>
<p>The view and the controller are very much mixed in Plone.</p>
<p>When you look at some of the older code of Plone you&#8217;ll see that the policy of keeping login insice python and representation in templates was not always enforced. You should nevertheless do it. You&#8217;ll end up with more than enough logic in the templates anyway. You&#8217;ll see now.</p>
<p>Let&#8217;s add this simple table to our template <tt class="docutils literal"><span class="pre">templates/talklistview.pt</span></tt>:</p>
<div class="highlight-html"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28</pre></div></td><td class="code"><div class="highlight"><pre><span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">&quot;listing&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;thead&gt;</span>
        <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;th&gt;</span>
                Title
            <span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;th&gt;</span>
                Speaker
            <span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;th&gt;</span>
                Audience
            <span class="nt">&lt;/th&gt;</span>
        <span class="nt">&lt;/tr&gt;</span>
    <span class="nt">&lt;/thead&gt;</span>
    <span class="nt">&lt;tbody&gt;</span>
        <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;td&gt;</span>
               The 7 sins of plone-development
            <span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;td&gt;</span>
                Philip Bauer
            <span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;td&gt;</span>
                Advanced
            <span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;/tr&gt;</span>
    <span class="nt">&lt;/tbody&gt;</span>
<span class="nt">&lt;/table&gt;</span>
</pre></div>
</td></tr></table></div>
<p>After we transform it we have a listing:</p>
<div class="highlight-html"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38</pre></div></td><td class="code"><div class="highlight"><pre><span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">&quot;listing&quot;</span> <span class="na">id=</span><span class="s">&quot;talks&quot;</span><span class="nt">&gt;</span>
    <span class="nt">&lt;thead&gt;</span>
        <span class="nt">&lt;tr&gt;</span>
            <span class="nt">&lt;th&gt;</span>
                Title
            <span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;th&gt;</span>
                Speaker
            <span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;th&gt;</span>
                Audience
            <span class="nt">&lt;/th&gt;</span>
        <span class="nt">&lt;/tr&gt;</span>
    <span class="nt">&lt;/thead&gt;</span>
    <span class="nt">&lt;tbody&gt;</span>
        <span class="nt">&lt;tr</span> <span class="na">tal:repeat=</span><span class="s">&quot;talk view/talks&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;td&gt;</span>
                <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;&quot;</span>
                   <span class="na">tal:attributes=</span><span class="s">&quot;href talk/url;</span>
<span class="s">                                   title talk/description&quot;</span>
                   <span class="na">tal:content=</span><span class="s">&quot;talk/title&quot;</span><span class="nt">&gt;</span>
                   The 7 sins of plone-development
                <span class="nt">&lt;/a&gt;</span>
            <span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">tal:content=</span><span class="s">&quot;talk/speaker&quot;</span><span class="nt">&gt;</span>
                Philip Bauer
            <span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">tal:content=</span><span class="s">&quot;talk/audience&quot;</span><span class="nt">&gt;</span>
                Advanced
            <span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;tr</span> <span class="na">tal:condition=</span><span class="s">&quot;not:view/talks&quot;</span><span class="nt">&gt;</span>
            <span class="nt">&lt;td</span> <span class="na">colspan=</span><span class="s">3</span><span class="nt">&gt;</span>
                No talks so far :-(
            <span class="nt">&lt;/td&gt;</span>
        <span class="nt">&lt;/tr&gt;</span>
    <span class="nt">&lt;/tbody&gt;</span>
<span class="nt">&lt;/table&gt;</span>
</pre></div>
</td></tr></table></div>
<p>I&#8217;ll explain some of the things in the TAL:</p>
<dl class="docutils">
<dt><tt class="docutils literal"><span class="pre">tal:repeat=&quot;talk</span> <span class="pre">view/talks&quot;</span></tt></dt>
<dd>we iterate over the list of dictionaries returned by our view. <tt class="docutils literal"><span class="pre">view/talks</span></tt> calles the method <tt class="docutils literal"><span class="pre">talks</span></tt> of our view and each <tt class="docutils literal"><span class="pre">talk</span></tt> is in turn a dictionary. Since TAL&#8217;s path-expressions for the lookup of values in dictionaries is the same as the attributes of objects we can write <tt class="docutils literal"><span class="pre">talk/somekey</span></tt> as we could <tt class="docutils literal"><span class="pre">view/somemethod</span></tt>. Handy but sometimes irritating since from looking at the page-template alone we have often no way of knowing if something is an attribute, a method or the value of a dict.</dd>
<dt><tt class="docutils literal"><span class="pre">tal:content=&quot;talk/speaker&quot;</span></tt></dt>
<dd>&#8216;speaker&#8217; is a key in the dict &#8216;talk&#8217;. We could also write <tt class="docutils literal"><span class="pre">tal:content=&quot;python:talk['speaker']&quot;</span></tt></dd>
<dt><tt class="docutils literal"><span class="pre">tal:condition=&quot;not:view/talks&quot;</span></tt></dt>
<dd>this is a fallback for when no talks are returned by out method talks. It then return an empty list (remember <tt class="docutils literal"><span class="pre">results</span> <span class="pre">=</span> <span class="pre">[]</span></tt>?)</dd>
<dt><tt class="docutils literal"><span class="pre">tal:content=&quot;talk/average_rating</span> <span class="pre">|&nbsp;nothing&quot;</span></tt></dt>
<dd><p class="first">you might remember there is no key &#8216;average_rating&#8217; in the dict that we return. The &#8216;|&#8217; (&#8220;or&#8221;) character is used to find an alternative value to a path if the first path evaluates to <tt class="docutils literal"><span class="pre">nothing</span></tt> or does not exist. The | (&#8220;or&#8221;) is the logical &#8216;or&#8217; and will be used if no value exists.</p>
<p>What will not work is <tt class="docutils literal"><span class="pre">tal:content=&quot;python:talk['average_rating']</span> <span class="pre">or</span> <span class="pre">''&quot;</span></tt>. Who knows what it will yield? We&#8217;ll get <tt class="docutils literal"><span class="pre">KeyError:</span> <span class="pre">'average_rating'</span></tt>. In fact it is bad practice to use | too often since it&#8217;ll swallow errors like a typo in <tt class="docutils literal"><span class="pre">tal:content=&quot;talk/averange_ratting</span> <span class="pre">|&nbsp;nothing&quot;</span></tt> and you might wonder why there are no ratings later on...</p>
<p class="last">Keep in mind that you can&#8217;t and should not use it to prevent errors like a try/except-block. But in this case it&#8217;s pretty useful since our code does not break event though we have not implemented ratings yet.</p>
</dd>
</dl>
</div>
<div class="section" id="setting-a-custom-view-as-default-view-on-an-object">
<h2>Setting a custom view as default-view on an object<a class="headerlink" href="#setting-a-custom-view-as-default-view-on-an-object" title="Permalink to this headline">¶</a></h2>
<p>We don&#8217;t want to always have to append /&#64;&#64;talklistview to out folder to get the view. There is a very easy way to set the view to the folder using the ZMI.</p>
<p>If we append <tt class="docutils literal"><span class="pre">/manage_propertiesForm</span></tt> we can set the property &#8220;layout&#8221; to <tt class="docutils literal"><span class="pre">talklistview</span></tt>.</p>
<p>To make views configurable so that editors can choose them we have to register the view for the content-type at hand in it&#8217;s FTI. To enableif for all folders we add  anew file <tt class="docutils literal"><span class="pre">profiles/default/types/Folder.xml</span></tt></p>
<div class="highlight-xml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span class="cp">&lt;?xml version=&quot;1.0&quot;?&gt;</span>
<span class="nt">&lt;object</span> <span class="na">name=</span><span class="s">&quot;Folder&quot;</span><span class="nt">&gt;</span>
 <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&quot;view_methods&quot;</span> <span class="na">purge=</span><span class="s">&quot;False&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;element</span> <span class="na">value=</span><span class="s">&quot;talklistview&quot;</span><span class="nt">/&gt;</span>
 <span class="nt">&lt;/property&gt;</span>
  <span class="nt">&lt;alias</span> <span class="na">from=</span><span class="s">&quot;@@talklistview&quot;</span> <span class="na">to=</span><span class="s">&quot;talklistview&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/object&gt;</span>
</pre></div>
</td></tr></table></div>
<p>After reapplying the typeinfo-profile of out addon (or simply reinstalling it) the content-type &#8220;Folder&#8221; is extended with our additional view-method and appears in the display-dropdown.</p>
<p>The <tt class="docutils literal"><span class="pre">purge=&quot;False&quot;</span></tt> append out view to the already existing ones instead of replacing them.</p>
</div>
<div class="section" id="adding-some-javascript-collective-js-datatables">
<h2>Adding some javascript (collective.js.datatables)<a class="headerlink" href="#adding-some-javascript-collective-js-datatables" title="Permalink to this headline">¶</a></h2>
<p>Here we use one of many nice feature build into Plone. The class=&#8221;listing&#8221; gives the table a nice style and makes the table sortable with some javascript.</p>
<p>But we could improve that table further by using a nice javascript-library called &#8220;datatables&#8221;. It might even become part of the Plone-core at some point.</p>
<p>Like for many js-libraries there is already a package that doe the plone-integration for us: <tt class="docutils literal"><span class="pre">collective.js.datatables</span></tt>. Like all python-packages you can find it on pypi: <a class="reference external" href="http://pypi.python.org/pypi/collective.js.datatables">http://pypi.python.org/pypi/collective.js.datatables</a></p>
<p>We already added the addon to our buildout and just have to activate it in our template.</p>
<div class="highlight-xml"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61</pre></div></td><td class="code"><div class="highlight"><pre><span class="nt">&lt;html</span> <span class="na">xmlns=</span><span class="s">&quot;http://www.w3.org/1999/xhtml&quot;</span> <span class="na">xml:lang=</span><span class="s">&quot;en&quot;</span> <span class="na">lang=</span><span class="s">&quot;en&quot;</span>
      <span class="na">metal:use-macro=</span><span class="s">&quot;context/main_template/macros/master&quot;</span>
      <span class="na">i18n:domain=</span><span class="s">&quot;ploneconf.site&quot;</span><span class="nt">&gt;</span>
<span class="nt">&lt;body&gt;</span>

<span class="hll"><span class="nt">&lt;metal:head</span> <span class="na">fill-slot=</span><span class="s">&quot;javascript_head_slot&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">    <span class="nt">&lt;link</span> <span class="na">rel=</span><span class="s">&quot;stylesheet&quot;</span> <span class="na">type=</span><span class="s">&quot;text/css&quot;</span> <span class="na">media=</span><span class="s">&quot;screen&quot;</span> <span class="na">href=</span><span class="s">&quot;++resource++jquery.datatables/media/css/jquery.dataTables.css&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">
</span><span class="hll">    <span class="nt">&lt;script</span> <span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span> <span class="na">src=</span><span class="s">&quot;++resource++jquery.datatables.js&quot;</span><span class="nt">&gt;&lt;/script&gt;</span>
</span><span class="hll">    <span class="nt">&lt;script</span> <span class="na">type=</span><span class="s">&quot;text/javascript&quot;</span><span class="nt">&gt;</span>
</span><span class="hll">        $(document).ready(function(){
</span><span class="hll">            var oTable = $(&#39;#talks&#39;).dataTable({
</span><span class="hll">            });
</span><span class="hll">        })
</span><span class="hll">    <span class="nt">&lt;/script&gt;</span>
</span><span class="hll"><span class="nt">&lt;/metal:head&gt;</span>
</span>
<span class="nt">&lt;metal:content-core</span> <span class="na">fill-slot=</span><span class="s">&quot;content-core&quot;</span><span class="nt">&gt;</span>

    <span class="nt">&lt;table</span> <span class="na">class=</span><span class="s">&quot;listing&quot;</span> <span class="na">id=</span><span class="s">&quot;talks&quot;</span><span class="nt">&gt;</span>
        <span class="nt">&lt;thead&gt;</span>
            <span class="nt">&lt;tr&gt;</span>
                <span class="nt">&lt;th&gt;</span>
                    Title
                <span class="nt">&lt;/th&gt;</span>
                <span class="nt">&lt;th&gt;</span>
                    Speaker
                <span class="nt">&lt;/th&gt;</span>
                <span class="nt">&lt;th&gt;</span>
                    Audience
                <span class="nt">&lt;/th&gt;</span>
            <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;/thead&gt;</span>
        <span class="nt">&lt;tbody&gt;</span>
            <span class="nt">&lt;tr</span> <span class="na">tal:repeat=</span><span class="s">&quot;talk view/talks&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;td&gt;</span>
                    <span class="nt">&lt;a</span> <span class="na">href=</span><span class="s">&quot;&quot;</span>
                       <span class="na">tal:attributes=</span><span class="s">&quot;href talk/url;</span>
<span class="s">                                       title talk/description&quot;</span>
                       <span class="na">tal:content=</span><span class="s">&quot;talk/title&quot;</span><span class="nt">&gt;</span>
                       The 7 sins of plone-development
                    <span class="nt">&lt;/a&gt;</span>
                <span class="nt">&lt;/td&gt;</span>
                <span class="nt">&lt;td</span> <span class="na">tal:content=</span><span class="s">&quot;talk/speaker&quot;</span><span class="nt">&gt;</span>
                    Philip Bauer
                <span class="nt">&lt;/td&gt;</span>
                <span class="nt">&lt;td</span> <span class="na">tal:content=</span><span class="s">&quot;talk/audience&quot;</span><span class="nt">&gt;</span>
                    Advanced
                <span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;/tr&gt;</span>
            <span class="nt">&lt;tr</span> <span class="na">tal:condition=</span><span class="s">&quot;not:view/talks&quot;</span><span class="nt">&gt;</span>
                <span class="nt">&lt;td</span> <span class="na">colspan=</span><span class="s">3</span><span class="nt">&gt;</span>
                    No talks so far :-(
                <span class="nt">&lt;/td&gt;</span>
            <span class="nt">&lt;/tr&gt;</span>
        <span class="nt">&lt;/tbody&gt;</span>
    <span class="nt">&lt;/table&gt;</span>

<span class="nt">&lt;/metal:content-core&gt;</span>
<span class="nt">&lt;/body&gt;</span>
<span class="nt">&lt;/html&gt;</span>
</pre></div>
</td></tr></table></div>
<p>We don&#8217;t need the css-class <tt class="docutils literal"><span class="pre">listing</span></tt> anymore since it might clash with datatables (it does not but still...).</p>
<p>The documentation of datatables is beyond our training.</p>
<p>We use METAL again but this time to fill a different slot. The &#8220;javascript_head_slot&#8221; is part of the html&#8217;s <tt class="docutils literal"><span class="pre">&lt;head&gt;</span></tt>-area in Plone and can be extended this way. We could also just put the code inline but having nicely ordered html is a good practice.</p>
<p>Let&#8217;s test it: <a class="reference external" href="http://localhost:8080/Plone/talklistview">http://localhost:8080/Plone/talklistview</a></p>
</div>
<div class="section" id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline">¶</a></h2>
<p>We created a nive listing, that can be called at any place in the website.</p>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="behaviors1.html" class="btn btn-neutral float-right" title="19. Behaviors"/>Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="views_2.html" class="btn btn-neutral" title="17. Views II: A default view for “talk”"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014, Philip Bauer, Patrick Gerken. Version 1.2.
    </p>
  </div>

  <a href="https://github.com/snide/sphinx_rtd_theme">Sphinx theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'1.2',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>